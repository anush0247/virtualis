package com.aakash.vlabs.quiz;

import android.app.Fragment;
import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.LinearLayout;
import android.widget.TextView;

public class Question extends Fragment {
	
	int currentId = 1;
	
	String Gift_qn = "";
	String[] parts = {};
	@Override
	public View onCreateView(LayoutInflater inflater, ViewGroup container,
			Bundle savedInstanceState) {
		// TODO Auto-generated method stub
		//return super.onCreateView(inflater, container, savedInstanceState);
		
		View view = inflater.inflate(R.layout.question, container, false);
		LinearLayout qun_layout = (LinearLayout) view.findViewById(R.id.myquestions_page);
		TextView mytext = new TextView(view.getContext());
		makeparts();
		mytext.setText("Question "+ currentId + "\n" + Gift_qn + "\n\n" 
				+ parts[0] + "\n"
				+ parts[1] + "\n"
				+ parts[2] + "\n");
		mytext.setPadding(20, 20, 20, 20);
		mytext.setTextSize(20);
		qun_layout.addView(mytext);
		return view;
	}
	
	public void setId(int id){
		this.currentId = id;
	}
	
	public void setGift_qn(String str){
		this.Gift_qn = str;
	}
	
	
	/*public void parseQuestion() {
		// take the question string and returns array containing string array
		// 0 - type , 1 - title, 2 - question , 3 - answer string
		String q = this.Gift_qn;
		parts  = new String[4];
		if (q.contains("{")) {
			int v = q.indexOf('{');
			char v2 = q.charAt(++v);
			switch (v2) {
			case '#':
				parts = makeparts("Numeric", q);
				break;
			case '~':
				if (q.contains("=")) {
					parts = makeparts("Multiple", q);
				} else {
					parts = makeparts("Multiple_many", q);
				}
				break;
			case '}':
				parts = makeparts("Essay", q);
				break;
			case 't':
			case 'T':
			case 'F':
			case 'f':
				parts = makeparts("True_false", q);
				break;
			case '=':
			case '\n':
				if (q.contains("~")) {
					if (q.contains("=")) {
						parts = makeparts("Multiple", q);
					} else {
						parts = makeparts("Multiple_many", q);
					}
				} else if (q.contains("->")) {
					parts = makeparts("Matching", q);
				} else {
					parts = makeparts("Short_Answer", q);
				}
				break;
			default:
				parts = makeparts("Missing_word", q);
			}
		} else {
			if (q.contains("//")) {
				parts = makeparts("Comment", q);
			} else {
				parts = makeparts("Description", q);
			}
		}
		
	}*/

	public void makeparts() {
		String s = this.Gift_qn;
		int v = s.indexOf('{');
		int v1 = s.indexOf('}');
		int v2 = s.indexOf(':', 2);
		String title = "";
		String question = (String) s.subSequence(0, v);
		String answerpart = (String) s.subSequence(v + 1, v1);
		if (s.startsWith("::")) {
			title = (String) s.subSequence(2, v2);
			v2 = v2 + 2;
			question = (String) s.subSequence(v2, v);
		}
		v1++;
		if (v1 != s.length() && s.charAt(v1) != '.') {
			question += "__________";
			question += s.subSequence(v1, s.length());
		}
		parts = new String[4];
		parts[0] = title;
		parts[1] = question;
		parts[2] = answerpart.replaceAll("^[ \t]+", "") ;
		parts[3] = getType(parts[2]);
		
	}

	private String getType(String q) {
		// TODO Auto-generated method stub
		char v2 = q.charAt(0);
		switch (v2) {
			case '#':
				return "Numeric";
			case '~':
				if (q.contains("=")) {
					return "Multiple";
				} else {
					return "Multiple_many";
				}
			case '}':
				return "Essay";
			case 't':
			case 'T':
			case 'F':
			case 'f':
				return "True_false";
			case '=':
			case '\n':
				if (q.contains("~")) {
					if (q.contains("=")) {
						return "Multiple";
					} else {
						return "Multiple_many";
					}
				} else if (q.contains("->")) {
					return "Matching";
				} else {
					return "Short_Answer";
				}
			default:
				return "Missing_word";
		}
		
	}


}
